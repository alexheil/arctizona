<%= @user.username %> - <%= @user.followers.count %>

<% if user_signed_in? && current_user != @user %>
  <div>
    <% if current_user.following?(@user) %>
      <%= form_for(current_user.active_relationships.find_by(followed_id: @user.id),
               html: { method: :delete }) do |f| %>
        <%= f.submit "Unfollow" %>
      <% end %>
    <% else %>
      <%= form_for(current_user.active_relationships.build) do |f| %>
        <div><%= hidden_field_tag :followed_id, @user.id %></div>
        <%= f.submit "Follow" %>
      <% end %>
    <% end %>
  </div>
<% end %>

<% unless @user.gallery.present? %>
  <% if current_user == @user %>
    <%= form_for(Gallery.new, url: user_gallery_path(@user)) do |f| %>
      <%= f.submit "Create gallery", data: { disable_with: 'Creating...' }, class: "submit-button" %>
    <% end %>
  <% end %>
<% end %>

<% if @user.gallery.present? %>
  you have a gallery

  <%= form_for(Album.new, url: user_gallery_albums_path(@user, @user.gallery)) do |f| %>
    <div class="field">
      <%= f.label :title, class: "label" %><br />
      <%= f.text_field :title, class: "text-field" %>
    </div>
    <%= f.submit "Create photo album", data: { disable_with: 'Creating...' }, class: "submit-button" %>
  <% end %>
  <%= @user.albums.count %>
  <% @user.gallery.albums.each do |album| %>
    <%= album.title %>

  <% end %>

<% end %>